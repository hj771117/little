# ==================== OpenClash â€” Smart å†…æ ¸ç»ˆæç¨³å®šç‰ˆï¼ˆ2025.12.02 ä¼˜åŒ–ï¼‰===================
# æ ¸å¿ƒä¼˜åŒ–ï¼šå¤§å¹…é™ä½ Smart åˆ‡æ¢é¢‘ç‡ + å°æ¹¾å½±è§† url-test + gvisor ä¸¢åŒ…ä¼˜åŒ– + å¥åº·æ£€æŸ¥æ›´ç¨³
# ç”Ÿæˆæ—¶é—´ï¼š2025-12-02

enable-emoji: true
prepend-emoji: true
rename-rule:
  - "|@ @"

# -------------------- è®¢é˜… --------------------
proxy-providers:
  æˆ‘çš„è®¢é˜…:
    type: http
    url: "https://sub.zgt161616.uk/zgt161616?sub"
    interval: 21600
    health-check:
      enable: true
      url: https://cp.cloudflare.com/generate_204
      interval: 600
      timeout: 5000
      expected-status: 204
    update-timer:
      - "0 */6 * * *"
    lazy: true

proxies:
  - { name: ç›´è¿, type: direct }
  - { name: æ‹’ç», type: reject }

# -------------------- LightGBM æ¨¡å‹ --------------------
model:
  enable: true
  url: "https://raw.githubusercontent.com/xyz1145/LightGBM-Model/main/model.bin"
  interval: 86400
  lazy: false

# -------------------- åŸºç¡€è®¾ç½® --------------------
port: 7890
socks-port: 7891
redir-port: 7892
mixed-port: 7893
tproxy-port: 7895
allow-lan: true
mode: rule
log-level: info
external-controller: 0.0.0.0:9090
secret: "123456"

# -------------------- DNSï¼ˆå¢å¼ºï¼‰ --------------------
dns:
  enable: true
  listen: 0.0.0.0:7874
  ipv6: true
  enhanced-mode: fake-ip
  fake-ip-range: 198.20.0.1/16
  nameserver:
    - 223.5.5.5
    - 114.114.114.114
    - https://1.1.1.1/dns-query
    - https://dns.google/dns-query
  fallback:
    - 1.1.1.1
    - 8.8.8.8
  fake-ip-filter-mode: blacklist
  fake-ip-filter:
    - +.lan
    - +.local
    - geosite:cn
    - +.internal
    - +.localdomain
  disable-unbound: false

# -------------------- TUNï¼ˆgvisor ç¨³å®šä¼˜åŒ–ï¼‰ --------------------
tun:
  enable: true
  stack: gvisor
  device: utun
  endpoint-independent-nat: true
  auto-route: false
  auto-detect-interface: false
  auto-redirect: false
  strict-route: false
  udp: true
  udp-relay: true
  mtu: 9000
  gso: true

profile:
  store-selected: true
  store-fake-ip: true

# -------------------- Smart å†…æ ¸ä¿å®ˆå‚æ•°ï¼ˆæ ¸å¿ƒç¨³å®šè¡¥ä¸ï¼‰ --------------------
smart-default: &smart-default
  type: smart
  include-all: true
  uselightgbm: true
  collectdata: true
  interval: 600  # å¢å¤§é—´éš”ï¼Œå‡å°‘åˆ‡æ¢é¢‘ç‡
  concurrency: 4  # é™åˆ¶å¹¶å‘æ•°ï¼Œé™ä½è¿‡è½½é£é™©
  tolerance: 80  # å¢åŠ å®¹å¿åº¦ï¼Œå‡å°‘åˆ‡æ¢è¿‡äºé¢‘ç¹
  latency-check:
    enable: true
    url: https://cp.cloudflare.com/generate_204
    interval: 300  # å»¶é•¿å»¶è¿Ÿæ£€æŸ¥çš„é—´éš”ï¼Œé¿å…é¢‘ç¹æ³¢åŠ¨
    timeout: 5000
    tolerance: 100  # æé«˜å®¹å¿åº¦ï¼Œå‡å°‘å°æ³¢åŠ¨å½±å“
    expected-status: 204
  disable-udp: false

default: &default
  type: select
  proxies:
    - ç›´è¿
    - æ‰€æœ‰-æ™ºé€‰
    - æ‰€æœ‰-æ‰‹é€‰
    - é¦™æ¸¯-æ•…è½¬
    - å°æ¹¾-æ•…è½¬
    - æ—¥æœ¬-æ•…è½¬
    - æ–°åŠ å¡-æ•…è½¬
    - éŸ©å›½-æ•…è½¬
    - ç¾å›½-æ•…è½¬
    - è‹±å›½-æ•…è½¬
    - å…¶ä»–-æ•…è½¬
    - æ‹’ç»

# -------------------- Proxy Groups --------------------
proxy-groups:
  - { name: ChatGPT, <<: *default }
  - { name: Gemini, <<: *default }
  - { name: Copilot, <<: *default }
  - { name: Perplexity, <<: *default }
  - { name: Claude, <<: *default }
  - { name: Meta AI, <<: *default }
  - { name: GitHub, <<: *default }
  - { name: Reddit, <<: *default }
  - { name: Telegram, <<: *default }
  - { name: WhatsApp, <<: *default }
  - { name: Facebook, <<: *default }
  - { name: YouTube, <<: *default }
  - { name: TikTok, <<: *default }
  - { name: Netflix, <<: *default }
  - { name: HBO, <<: *default }
  - { name: Disney, <<: *default }
  - { name: Amazon, <<: *default }
  - { name: Crunchyroll, <<: *default }
  - { name: Spotify, <<: *default }
  - { name: Nvidia, <<: *default }
  - { name: Steam, <<: *default }
  - { name: Games, <<: *default }
  - { name: Crypto, <<: *default }
  - { name: Apple, <<: *default }
  - { name: Google, <<: *default }
  - { name: Microsoft, <<: *default }
  - { name: Test, <<: *default }
  - { name: Block, <<: *default }
  - { name: å›½å¤–, <<: *default }
  - { name: å›½å†…, <<: *default }
  - { name: å…¶ä»–, <<: *default }

  # å°æ¹¾å½±è§†æ”¹ä¸ºæ›´ç¨³å®šçš„ url-test
  - name: å°æ¹¾å½±è§†
    type: url-test
    url: https://cp.cloudflare.com/generate_204
    interval: 600
    tolerance: 100
    lazy: true
    proxies:
      - å°æ¹¾-æ™ºé€‰
      - å°æ¹¾-æ‰‹é€‰
      - é¦™æ¸¯-æ™ºé€‰
      - é¦™æ¸¯-æ‰‹é€‰
      - æ—¥æœ¬-æ™ºé€‰
      - æ—¥æœ¬-æ‰‹é€‰

  - name: æ‰€æœ‰-æ‰‹é€‰
    type: select
    include-all: true
    filter: "^((?!(ç›´è¿|æ‹’ç»)).)*$"

  - name: æ‰€æœ‰-æ™ºé€‰
    <<: *smart-default
    filter: "^((?!(ç›´è¿|æ‹’ç»)).)*$"

  - name: é¦™æ¸¯-æ•…è½¬
    type: fallback
    interval: 300
    lazy: false
    proxies: [é¦™æ¸¯-æ‰‹é€‰, é¦™æ¸¯-æ™ºé€‰]

  - name: é¦™æ¸¯-æ‰‹é€‰
    type: select
    include-all: true
    filter: "(?=.*(å¹¿æ¸¯|é¦™æ¸¯|HK|Hong Kong|ğŸ‡­ğŸ‡°)).*$"

  - name: é¦™æ¸¯-æ™ºé€‰
    <<: *smart-default
    filter: "(?=.*(å¹¿æ¸¯|é¦™æ¸¯|HK|Hong Kong|ğŸ‡­ğŸ‡°)).*$"

  - name: å°æ¹¾-æ•…è½¬
    type: fallback
    interval: 300
    lazy: false
    proxies: [å°æ¹¾-æ‰‹é€‰, å°æ¹¾-æ™ºé€‰]

  - name: å°æ¹¾-æ‰‹é€‰
    type: select
    include-all: true
    filter: "(?=.*(å¹¿å°|å°æ¹¾|å°åŒ—|å°|TW|Tai Wan|ğŸ‡¹ğŸ‡¼)).*$"

  - name: å°æ¹¾-æ™ºé€‰
    <<: *smart-default
    filter: "(?=.*(å¹¿å°|å°æ¹¾|å°åŒ—|å°|TW|Tai Wan|ğŸ‡¹ğŸ‡¼)).*$"

  - name: æ—¥æœ¬-æ•…è½¬
    type: fallback
    interval: 300
    lazy: false
    proxies: [æ—¥æœ¬-æ‰‹é€‰, æ—¥æœ¬-æ™ºé€‰]

  - name: æ—¥æœ¬-æ‰‹é€‰
    type: select
    include-all: true
    filter: "(?=.*(å¹¿æ—¥|æ—¥æœ¬|JP|ä¸œäº¬|å¤§é˜ª|ğŸ‡¯ğŸ‡µ)).*$"

  - name: æ—¥æœ¬-æ™ºé€‰
    <<: *smart-default
    filter: "(?=.*(å¹¿æ—¥|æ—¥æœ¬|JP|ä¸œäº¬|å¤§é˜ª|ğŸ‡¯ğŸ‡µ)).*$"

  - name: æ–°åŠ å¡-æ•…è½¬
    type: fallback
    interval: 300
    lazy: false
    proxies: [æ–°åŠ å¡-æ‰‹é€‰, æ–°åŠ å¡-æ™ºé€‰]

  - name: æ–°åŠ å¡-æ‰‹é€‰
    type: select
    include-all: true
    filter: "(?=.*(å¹¿æ–°|æ–°åŠ å¡|SG|SIN|SGP|ğŸ‡¸ğŸ‡¬)).*$"

  - name: æ–°åŠ å¡-æ™ºé€‰
    <<: *smart-default
    filter: "(?=.*(å¹¿æ–°|æ–°åŠ å¡|SG|SIN|SGP|ğŸ‡¸ğŸ‡¬)).*$"

  - name: éŸ©å›½-æ•…è½¬
    type: fallback
    interval: 300
    lazy: false
    proxies: [éŸ©å›½-æ‰‹é€‰, éŸ©å›½-æ™ºé€‰]

  - name: éŸ©å›½-æ‰‹é€‰
    type: select
    include-all: true
    filter: "(?=.*(å¹¿éŸ©|éŸ©å›½|KR|é¦–å°”|ğŸ‡°ğŸ‡·)).*$"

  - name: éŸ©å›½-æ™ºé€‰
    <<: *smart-default
    filter: "(?=.*(å¹¿éŸ©|éŸ©å›½|KR|é¦–å°”|ğŸ‡°ğŸ‡·)).*$"

  - name: ç¾å›½-æ•…è½¬
    type: fallback
    interval: 300
    lazy: false
    proxies: [ç¾å›½-æ‰‹é€‰, ç¾å›½-æ™ºé€‰]

  - name: ç¾å›½-æ‰‹é€‰
    type: select
    include-all: true
    filter: "(?=.*(å¹¿ç¾|ç¾å›½|US|çº½çº¦|ğŸ‡ºğŸ‡¸)).*$"

  - name: ç¾å›½-æ™ºé€‰
    <<: *smart-default
    filter: "(?=.*(å¹¿ç¾|ç¾å›½|US|çº½çº¦|ğŸ‡ºğŸ‡¸)).*$"

  - name: è‹±å›½-æ•…è½¬
    type: fallback
    interval: 300
    lazy: false
    proxies: [è‹±å›½-æ‰‹é€‰, è‹±å›½-æ™ºé€‰]

  - name: è‹±å›½-æ‰‹é€‰
    type: select
    include-all: true
    filter: "(?=.*(è‹±å›½|UK|ä¼¦æ•¦|ğŸ‡¬ğŸ‡§)).*$"

  - name: è‹±å›½-æ™ºé€‰
    <<: *smart-default
    filter: "(?=.*(è‹±å›½|UK|ä¼¦æ•¦|ğŸ‡¬ğŸ‡§)).*$"

  - name: å…¶ä»–-æ•…è½¬
    type: fallback
    interval: 300
    lazy: false
    proxies: [å…¶ä»–-æ‰‹é€‰, å…¶ä»–-æ™ºé€‰]

  - name: å…¶ä»–-æ‰‹é€‰
    type: select
    include-all: true
    filter: "^((?!(ç›´è¿|æ‹’ç»|å¹¿æ¸¯|é¦™æ¸¯|HK|å¹¿å°|å°æ¹¾|TW|å¹¿æ—¥|æ—¥æœ¬|JP|å¹¿æ–°|æ–°åŠ å¡|SG|å¹¿éŸ©|éŸ©å›½|KR|å¹¿ç¾|ç¾å›½|US|è‹±å›½|UK)).)*$"

  - name: å…¶ä»–-æ™ºé€‰
    <<: *smart-default
    filter: "^((?!(ç›´è¿|æ‹’ç»|å¹¿æ¸¯|é¦™æ¸¯|HK|å¹¿å°|å°æ¹¾|TW|å¹¿æ—¥|æ—¥æœ¬|JP|å¹¿æ–°|æ–°åŠ å¡|SG|å¹¿éŸ©|éŸ©å›½|KR|å¹¿ç¾|ç¾å›½|US|è‹±å›½|UK)).)*$"

  # ä¿åº•ç»„ï¼Œé˜²æ­¢æ­£åˆ™æ¼ç½‘
  - name: æ¼ç½‘ä¹‹é±¼
    type: select
    proxies:
      - æ‰€æœ‰-æ™ºé€‰
      - ç›´è¿
    include-all: true
    filter: ".*"

# -------------------- è§„åˆ™ï¼ˆä¿æŒæœ€æ–°ï¼‰ --------------------
rules:
  - RULE-SET,TEST-Domain,Test
  - RULE-SET,Block-Domain,Block
  - RULE-SET,ChatGPT-Domain,ChatGPT
  - RULE-SET,Claude-Domain,Claude
  - RULE-SET,MetaAI-Domain,Meta AI
  - RULE-SET,Perplexity-Domain,Perplexity
  - RULE-SET,Copilot-Domain,Copilot
  - RULE-SET,Gemini-Domain,Gemini
  - RULE-SET,GitHub-Domain,GitHub
  - RULE-SET,Telegram-Domain,Telegram
  - RULE-SET,Telegram-IP,Telegram
  - RULE-SET,WhatsApp-Domain,WhatsApp
  - RULE-SET,Facebook-Domain,Facebook
  - RULE-SET,Apple-Domain,Apple
  - RULE-SET,Apple-CN-Domain,Apple
  - RULE-SET,Microsoft-Domain,Microsoft
  - RULE-SET,OKX-Domain,Crypto
  - RULE-SET,Bybit-Domain,Crypto
  - RULE-SET,Binance-Domain,Crypto
  - RULE-SET,Youtube-Domain,YouTube
  - RULE-SET,TikTok-Domain,TikTok
  - RULE-SET,Netflix-Domain,Netflix
  - RULE-SET,Netflix-IP,Netflix,no-resolve
  - RULE-SET,Disney-Domain,Disney
  - RULE-SET,Amazon-Domain,Amazon
  - RULE-SET,Crunchyroll-Domain,Crunchyroll
  - RULE-SET,HBO-Domain,HBO
  - RULE-SET,Spotify-Domain,Spotify
  - RULE-SET,Steam-Domain,Steam
  - RULE-SET,Epic-Domain,Games
  - RULE-SET,EA-Domain,Games
  - RULE-SET,Blizzard-Domain,Games
  - RULE-SET,UBI-Domain,Games
  - MATCH,å…¶ä»–

# -------------------- rule-providersï¼ˆå…¨éƒ¨ mrs/raw æœ€æ–°åœ°å€ï¼‰ --------------------
rule-anchor:
  ip: &ip { type: http, interval: 86400, behavior: ipcidr, format: mrs }
  domain: &domain { type: http, interval: 86400, behavior: domain, format: mrs }
  class: &class { type: http, interval: 86400, behavior: classical, format: text }

rule-providers:
  TEST-Domain: { <<: *class, url: "https://raw.githubusercontent.com/liandu2024/clash/refs/heads/main/list/Check.list" }
  ChatGPT-Domain: { <<: *domain, url: "https://raw.githubusercontent.com/metacubex/meta-rules-dat/refs/heads/meta/geo/geosite/openai.mrs" }
  Claude-Domain: { <<: *class, url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/refs/heads/master/rule/Clash/Claude/Claude.list" }
  MetaAI-Domain: { <<: *class, url: "https://raw.githubusercontent.com/liandu2024/clash/refs/heads/main/list/MetaAi.list" }
  Perplexity-Domain: { <<: *domain, url: "https://raw.githubusercontent.com/metacubex/meta-rules-dat/refs/heads/meta/geo/geosite/perplexity.mrs" }
  Copilot-Domain: { <<: *class, url: "https://raw.githubusercontent.com/liandu2024/clash/refs/heads/main/list/Copilot.list" }
  Gemini-Domain: { <<: *class, url: "https://raw.githubusercontent.com/liandu2024/clash/refs/heads/main/list/Gemini.list" }
  GitHub-Domain: { <<: *domain, url: "https://raw.githubusercontent.com/metacubex/meta-rules-dat/refs/heads/meta/geo/geosite/github.mrs" }
  Telegram-Domain: { <<: *domain, url: "https://raw.githubusercontent.com/metacubex/meta-rules-dat/refs/heads/meta/geo/geosite/telegram.mrs" }
  Telegram-IP: { <<: *ip, url: "https://raw.githubusercontent.com/metacubex/meta-rules-dat/refs/heads/meta/geo/geoip/telegram.mrs" }
  WhatsApp-Domain: { <<: *class, url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/refs/heads/master/rule/Clash/Whatsapp/Whatsapp.list" }
  Facebook-Domain: { <<: *domain, url: "https://raw.githubusercontent.com/metacubex/meta-rules-dat/refs/heads/meta/geo/geosite/facebook.mrs" }
  Amazon-Domain: { <<: *domain, url: "https://raw.githubusercontent.com/metacubex/meta-rules-dat/refs/heads/meta/geo/geosite/amazon.mrs" }
  Apple-CN-Domain: { <<: *domain, url: "https://raw.githubusercontent.com/metacubex/meta-rules-dat/refs/heads/meta/geo/geosite/apple-cn.mrs" }
  Apple-Domain: { <<: *domain, url: "https://raw.githubusercontent.com/metacubex/meta-rules-dat/refs/heads/meta/geo/geosite/apple.mrs" }
  Microsoft-Domain: { <<: *domain, url: "https://raw.githubusercontent.com/metacubex/meta-rules-dat/refs/heads/meta/geo/geosite/microsoft.mrs" }
  OKX-Domain: { <<: *domain, url: "https://raw.githubusercontent.com/metacubex/meta-rules-dat/refs/heads/meta/geo/geosite/okx.mrs" }
  Bybit-Domain: { <<: *domain, url: "https://raw.githubusercontent.com/metacubex/meta-rules-dat/refs/heads/meta/geo/geosite/bybit.mrs" }
  Binance-Domain: { <<: *domain, url: "https://raw.githubusercontent.com/metacubex/meta-rules-dat/refs/heads/meta/geo/geosite/binance.mrs" }
  TikTok-Domain: { <<: *domain, url: "https://raw.githubusercontent.com/metacubex/meta-rules-dat/refs/heads/meta/geo/geosite/tiktok.mrs" }
  Netflix-Domain: { <<: *domain, url: "https://raw.githubusercontent.com/metacubex/meta-rules-dat/refs/heads/meta/geo/geosite/netflix.mrs" }
  Netflix-IP: { <<: *ip, url: "https://raw.githubusercontent.com/metacubex/meta-rules-dat/refs/heads/meta/geo/geoip/netflix.mrs" }
  Disney-Domain: { <<: *domain, url: "https://raw.githubusercontent.com/metacubex/meta-rules-dat/refs/heads/meta/geo/geosite/disney.mrs" }
  HBO-Domain: { <<: *domain, url: "https://raw.githubusercontent.com/metacubex/meta-rules-dat/refs/heads/meta/geo/geosite/hbo.mrs" }
  Spotify-Domain: { <<: *domain, url: "https://raw.githubusercontent.com/metacubex/meta-rules-dat/refs/heads/meta/geo/geosite/spotify.mrs" }
  Steam-Domain: { <<: *domain, url: "https://raw.githubusercontent.com/metacubex/meta-rules-dat/refs/heads/meta/geo/geosite/steam.mrs" }
  Epic-Domain: { <<: *class, url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Epic/Epic.list" }
  EA-Domain: { <<: *class, url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/EA/EA.list" }
  Blizzard-Domain: { <<: *class, url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Blizzard/Blizzard.list" }
  UBI-Domain: { <<: *class, url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/UBI/UBI.list" }
  PlayStation-Domain: { <<: *class, url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/refs/heads/master/rule/Clash/PlayStation/PlayStation.list" }
  Nintend-Domain: { <<: *class, url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/refs/heads/master/rule/Clash/Nintendo/Nintendo.list" }
  Proxy-Domain: { <<: *class, url: "https://raw.githubusercontent.com/liandu2024/clash/refs/heads/main/list/Proxy.list" }
  Globe-Domain: { <<: *class, url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/refs/heads/master/rule/Clash/Global/Global.list" }
  Direct-Domain: { <<: *class, url: "https://raw.githubusercontent.com/liandu2024/clash/refs/heads/main/list/Direct.list" }
  China-Domain: { <<: *domain, url: "https://raw.githubusercontent.com/metacubex/meta-rules-dat/refs/heads/meta/geo/geosite/cn.mrs" }
  China-IP: { <<: *ip, url: "https://raw.githubusercontent.com/metacubex/meta-rules-dat/refs/heads/meta/geo/geoip/cn.mrs" }
  Private-Domain: { <<: *domain, url: "https://raw.githubusercontent.com/metacubex/meta-rules-dat/refs/heads/meta/geo/geosite/private.mrs" }
  Block-Domain: { <<: *class, url: "https://raw.githubusercontent.com/liandu2024/clash/refs/heads/main/list/Block.list" }
  Nvidia-Domain: { <<: *class, url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/refs/heads/master/rule/Clash/Nvidia/Nvidia.list" }
  Crunchyroll-Domain: { <<: *class, url: "https://raw.githubusercontent.com/liandu2024/clash/refs/heads/main/list/Crunchyroll.list" }
  Reddit-Domain: { <<: *domain, url: "https://raw.githubusercontent.com/metacubex/meta-rules-dat/refs/heads/meta/geo/geosite/reddit.mrs" }
  Youtube-Domain: { <<: *domain, url: "https://raw.githubusercontent.com/metacubex/meta-rules-dat/refs/heads/meta/geo/geosite/youtube.mrs" }
  Google-Domain: { <<: *domain, url: "https://raw.githubusercontent.com/metacubex/meta-rules-dat/refs/heads/meta/geo/geosite/google.mrs" }
  Google-IP: { <<: *ip, url: "https://raw.githubusercontent.com/metacubex/meta-rules-dat/refs/heads/meta/geo/geoip/google.mrs" }

# æ–‡ä»¶ç»“æŸ
